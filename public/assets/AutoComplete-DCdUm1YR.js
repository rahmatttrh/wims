import{N as ve,x as me,G as X,E as ge,q as ce,s as de,j as ye,k as b,m as H,l as ne,O as ue,r as be,c as j,o as p,b as V,d as _,a as M,t as D,y as se,g as pe,P as he,n as ee,B as J,A as ke,F as oe,i as we}from"./app-CmanO5vD.js";import{T as je}from"./Label-BFNS-ixp.js";import{T as Se}from"./InputError-IXNDXV76.js";const xe=()=>{const a={withCredentials:!0,headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}};let h=ve.create(a);return h.interceptors.request.use(function(y){return y}),h.interceptors.response.use(y=>y,y=>(y.response?.data?.errors?console.log(y.response.data.errors):y.response?.data?.message&&console.log(y.response.data.message),y.response.status===401&&me.visit("/login"),Promise.reject(y))),typeof window<"u"&&(window.axios=h),h},ie=xe();var te,re;function Ve(){if(re)return te;re=1;var a="Expected a function",h=NaN,y="[object Symbol]",L=/^\s+|\s+$/g,T=/^[-+]0x[0-9a-f]+$/i,K=/^0b[01]+$/i,Q=/^0o[0-7]+$/i,q=parseInt,e=typeof X=="object"&&X&&X.Object===Object&&X,r=typeof self=="object"&&self&&self.Object===Object&&self,o=e||r||Function("return this")(),W=Object.prototype,N=W.toString,F=Math.max,Y=Math.min,c=function(){return o.Date.now()};function O(u,f,k){var B,S,P,E,i,x,R=0,U=!1,$=!1,A=!0;if(typeof u!="function")throw new TypeError(a);f=I(f)||0,m(k)&&(U=!!k.leading,$="maxWait"in k,P=$?F(I(k.maxWait)||0,f):P,A="trailing"in k?!!k.trailing:A);function z(v){var C=B,G=S;return B=S=void 0,R=v,E=u.apply(G,C),E}function t(v){return R=v,i=setTimeout(d,f),U?z(v):E}function n(v){var C=v-x,G=v-R,ae=f-C;return $?Y(ae,P-G):ae}function l(v){var C=v-x,G=v-R;return x===void 0||C>=f||C<0||$&&G>=P}function d(){var v=c();if(l(v))return w(v);i=setTimeout(d,n(v))}function w(v){return i=void 0,A&&B?z(v):(B=S=void 0,E)}function le(){i!==void 0&&clearTimeout(i),R=0,B=x=S=i=void 0}function fe(){return i===void 0?E:w(c())}function Z(){var v=c(),C=l(v);if(B=arguments,S=this,x=v,C){if(i===void 0)return t(x);if($)return i=setTimeout(d,f),z(x)}return i===void 0&&(i=setTimeout(d,f)),E}return Z.cancel=le,Z.flush=fe,Z}function m(u){var f=typeof u;return!!u&&(f=="object"||f=="function")}function g(u){return!!u&&typeof u=="object"}function s(u){return typeof u=="symbol"||g(u)&&N.call(u)==y}function I(u){if(typeof u=="number")return u;if(s(u))return h;if(m(u)){var f=typeof u.valueOf=="function"?u.valueOf():u;u=m(f)?f+"":f}if(typeof u!="string")return u===0?u:+u;u=u.replace(L,"");var k=K.test(u);return k||Q.test(u)?q(u.slice(2),k?2:8):T.test(u)?h:+u}return te=O,te}var Te=Ve();const Ke=ge(Te);function Ie(a,h,y){if(!a)throw new Error("A target component has to be provided.");if(!h)throw new Error("A callback has to be provided.");const L=T=>{T.target===a.value||T.composedPath().includes(a.value)||T.target===y.value||T.composedPath().includes(y.value)||typeof h=="function"&&h()};ce(()=>{window.addEventListener("click",L)}),de(()=>{window.removeEventListener("click",L)})}const Ee={class:"flex items-center justify-between"},Ae=["for"],Be=["id","readonly","placeholder"],Ce=["id"],Le=["id"],Oe=["id","onClick"],Pe={class:"ml-3 block font-normal truncate"},Re={key:1,class:"bg-blue-600 text-white cursor-default select-none relative py-2"},$e={class:"flex items-center"},Ne={class:"ml-3 block font-normal truncate"},Fe={key:0},ze={key:1},Me={key:2},De={key:3},Ue={__name:"AutoComplete",props:{id:{type:String,default(){return Math.random().toString().replace("0.","1")}},size:String,label:String,error:String,action:Function,addResult:Array,position:String,valueKey:String,labelKey:String,disabled:Boolean,actionText:String,defaultText:String,placeholder:String,disable:[String,Number],suggestions:[String,Array],selectedValues:[String,Array],modelValue:[String,Number,Array],json:{type:Boolean,default:!0},hideIcon:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},keepFocus:{type:Boolean,default:!1},searchable:{type:Boolean,default:!0},placement:{type:String,default:"bottom"},resetSearch:{type:Boolean,default:!1},inputClass:{type:String,default:""}},emits:["change","update:modelValue"],setup(a,{emit:h}){const{t:y}=ye({}),L=b(null),T=b(null),K=h,Q=b(!1),q=b(null),e=a,r=b(""),o=b([]),W=b(null),N=b(!1),F=b(!1),Y=b(""),c=b(null),O=b(!1),m=b(null),g=b([]),s=b([]);H(()=>e.modelValue,async t=>{if(!t)z(),await i();else if(e.multiple){let n=s.value.map(l=>e.json?l[e.valueKey]:l);t.toString()!==n.toString()&&await f()}else Q.value=!0,await f()}),H(()=>e.suggestions,t=>o.value=t),H(()=>e.addResult,async t=>{t&&t.value&&(o.value.push(t.value),c.value=t.value,m.value=t.value,A(c.value),setTimeout(()=>{r.value=e.json?t.value[e.labelKey]:t.value,K("update:modelValue",t.value)},100))}),H(r,t=>{e.searchable&&(N.value=!0,Array.isArray(e.suggestions)?e.multiple&&Array.isArray(e.suggestions)?o.value=e.suggestions:o.value=t?e.suggestions.filter(n=>S(n,t)):e.suggestions:t&&(O.value=!0,B(t)))});const I=ne(()=>S(m.value)),u=ne(()=>P(m.value));Ie(T,()=>i(),L),de(()=>{e.multiple&&window.removeEventListener("click",k)}),ce(async()=>{e.multiple&&window.addEventListener("click",k),await f()});const f=async()=>{Array.isArray(e.suggestions)&&(o.value=e.suggestions),e.modelValue&&(g.value=[],Array.isArray(e.suggestions)?(e.multiple?(e.selectedValues?(s.value=e.selectedValues,r.value=e.selectedValues.join(", ")):s.value=e.suggestions.filter(t=>t==e.modelValue||t[e.valueKey]==e.modelValue||e.modelValue.filter(n=>n==t[e.valueKey])[0]||e.modelValue.filter(n=>n[e.valueKey]==t[e.valueKey])[0]||t.id==e.modelValue),e.json?e.suggestions.map((t,n)=>{s.value.find(l=>l[e.valueKey]==t[e.valueKey])&&(g.value=[...g.value,n])}):e.suggestions.map((t,n)=>{s.value.includes(t)&&(g.value=[...g.value,n])}),r.value=s.value.map(t=>e.json?t[e.labelKey]:t).join(", ")):e.json?(m.value=e.suggestions.find(t=>t==e.modelValue||t[e.valueKey]==e.modelValue||t.value==e.modelValue||t.id==e.modelValue),c.value=e.suggestions.findIndex(t=>t==e.modelValue||t[e.valueKey]==e.modelValue||t.value==e.modelValue||t.id==e.modelValue),r.value=I.value):m.value=e.modelValue,await ue(),await i(null,!0)):F.value||ie.post(e.suggestions,{id:e.modelValue}).then(t=>{e.multiple?(c.value=0,o.value=t.data,t.data.map(async(n,l)=>await A(l)),i(null,!0)):(c.value=0,o.value=t.data,m.value=t.data[0],r.value=S(m.value))}).finally(async()=>{await i(),O.value=!1}))},k=t=>{if(t.target==q.value||t.composedPath().includes(q.value))return!1;i(t,!0)},B=Ke(t=>{let n=o.value;n?.length&&n[0],!F.value&&t&&t!==I.value?(Y.value=t,ie.post(e.suggestions,{search:t}).then(l=>{o.value=l.data,o.value.length==1&&A(0)}).finally(()=>O.value=!1)):O.value=!1,F.value=!1},300),S=(t,n)=>{if(t===null)return null;if(typeof t!="object")return t;let l="";return e.labelKey?l=e.labelKey:t.label!==void 0?l="label":t.name!==void 0&&(l="name"),n?l?t[l].toLowerCase().includes(n.toString().toLowerCase()):t.toLowerCase().includes(n.toLowerCase()):l?t[l]:t},P=t=>{if(t===null)return null;if(typeof t!="object")return t;let n="";return e.valueKey?n=e.valueKey:t.value!==void 0?n="value":t.id!==void 0&&(n="id"),n?t[n]:t},E=()=>{if(e.disabled)return!1;N.value=!0,e.multiple?Array.isArray(e.suggestions)&&(o.value=e.suggestions):(r.value=null,W.value.select(),m.value||(c.value=0),document.getElementById("ac-"+e.id)?.scrollTo({top:(document.getElementById("s"+c.value)?.offsetTop||80)-80}))},i=async(t,n,l=!1)=>{if(l)return setTimeout(i,200),!1;!e.multiple||n?(m.value&&(r.value=I.value),await ue(),setTimeout(()=>N.value=!1,10)):s.value&&s.value.length&&(r.value=s.value.map(d=>e.json?d[e.labelKey]:d).join(", "),r.value=r.value||I.value)},x=async t=>(t.preventDefault(),t.stopImmediatePropagation(),A(c.value),await i(),t.stopPropagation(),!1),R=t=>(t.preventDefault(),t.stopPropagation(),c.value>0&&c.value--,e.multiple||document.getElementById("ac-"+e.id)?.scrollTo({top:(document.getElementById("s"+c.value)?.offsetTop||80)-80}),!1),U=t=>(t.preventDefault(),t.stopPropagation(),c.value<o.value.length-1&&c.value++,e.multiple||document.getElementById("ac-"+e.id)?.scrollTo({top:(document.getElementById("s"+c.value)?.offsetTop||80)-80}),!1),$=t=>e.multiple?g.value.includes(t):t==c.value,A=async(t,n=!1)=>{F.value=!0,t!==void 0&&(e.multiple?(e.json&&s.value.find(l=>l[e.valueKey]==o.value[t][e.valueKey])?s.value=s.value.filter(l=>l[e.valueKey]!=o.value[t][e.valueKey]):s.value.find(l=>l==o.value[t][e.valueKey])?s.value=s.value.filter(l=>l!=o.value[t][e.valueKey]):s.value=[...s.value,o.value[t]],g.value=[],e.multiple?o.value.map((l,d)=>{e.json&&s.value.find(w=>w[e.valueKey]==l[e.valueKey])?g.value=[...g.value,d]:s.value.includes(l)&&(g.value=[...g.value,d])}):e.suggestions.map((l,d)=>{e.json&&s.value.find(w=>w[e.valueKey]==l[e.valueKey])?g.value=[...g.value,d]:s.value.includes(l)&&(g.value=[...g.value,d])}),K("update:modelValue",e.json?s.value.map(l=>l[e.valueKey]):s.value),K("change",s.value),r.value=s.value.map(l=>e.json?l[e.labelKey]:l).join(", "),r.value=r.value||I.value):(c.value=t,m.value=o.value[t],K("update:modelValue",e.json?u.value:m.value),K("change",m.value),r.value=e.resetSearch?null:I.value,await i())),n&&(o.value=[]),e.resetSearch&&(m.value=null,r.value=""),e.keepFocus&&W.value.focus()},z=async()=>{r.value="",c.value=0,m.value=null,g.value=[],s.value=[],K("change",null),K("update:modelValue",""),await i()};return(t,n)=>{const l=be("Icons");return p(),j("div",{ref_key:"excludeRef",ref:L,class:"col-span-6 sm:col-span-4 relative mb-2"},[V("div",Ee,[a.label?(p(),_(je,{key:0,for:a.id,value:a.label,class:"inline-block"},null,8,["for","value"])):M("",!0),a.actionText&&a.action?(p(),j("button",{key:1,type:"button",onClick:n[0]||(n[0]=d=>a.action()),class:"link text-sm focus:ring-0"},D(a.actionText),1)):M("",!0)]),V("div",{class:"relative flex items-center",ref_key:"auto_complete",ref:q},[V("label",{for:a.id,class:"inline-block cursor-pointer absolute top-2 right-0 border border-transparent p-2 text-gray-500"},[a.hideIcon?M("",!0):(p(),_(l,{key:0,name:"chevron-down",size:"size-4"}))],8,Ae),a.clearable&&a.modelValue?(p(),j("button",{key:0,type:"button",tabindex:"-1",onClick:n[1]||(n[1]=d=>z()),class:"cursor-pointer focus:outline-hidden absolute top-2 right-6 border border-transparent p-2 text-gray-500 hover:text-red-500"},[pe(l,{name:"cross",size:"size-4"})])):M("",!0),se(V("input",{id:a.id,ref_key:"input",ref:W,onFocus:E,onClick:E,onKeydown:[J(R,["up"]),J(U,["down"]),J(x,["left"]),J(x,["right"])],"onUpdate:modelValue":n[2]||(n[2]=d=>r.value=d),autocomplete:"none",readonly:!a.searchable||a.disabled,placeholder:a.placeholder||a.label,class:ee([[a.clearable?"pr-16":"pr-8",a.inputClass||"mt-1 border focus rounded-md shadow-xs",a.size=="small"?"py-1.5 pl-2 text-sm":"py-2 pl-4 text-base",a.error?"border-red-500":"border-gray-300 ",a.disabled?"opacity-60 focus:border-gray-200 focus:ring-0":"focus:border-blue-500 focus:ring-blue-500 "],"block w-full"])},null,42,Be),[[he,r.value]]),se(V("div",{ref_key:"componentRef",ref:T,class:ee(["absolute w-full rounded-md z-20",a.placement=="top"?"mb-1 bottom-full "+a.position:"mt-1 top-full "+a.position])},[V("ul",{id:"ac-"+a.id,class:"max-h-56 rounded-md bg-white border text-base overflow-auto focus:outline-hidden border-blue-300 ring-2 ring-blue-200/50 sm:text-sm"},[o.value&&o.value.length?(p(!0),j(oe,{key:0},we(o.value,(d,w)=>(p(),j(oe,{key:w},[a.disable&&a.disable==P()?M("",!0):(p(),j("li",{key:0,id:"s"+w},[V("button",{type:"button",id:a.id+"-"+w,onClick:le=>A(w),class:ee([$(w)?"bg-blue-500 text-white ":"text-focus","w-full text-left flex items-center select-none relative py-2 hover:bg-blue-200 hover:text-blue-800 focus:outline-hidden focus:ring-0 focus:rounded-none"])},[V("span",Pe,D(d.label||S(d)),1)],10,Oe)],8,Le))],64))),128)):(p(),j("li",Re,[V("div",$e,[V("span",Ne,[O.value?(p(),j("span",Fe,D(t.$t("Searching for results"))+"...",1)):o.value==null?(p(),j("span",ze,D(t.$t("Scan barcode or search items for next")),1)):a.json?(p(),j("span",Me,D(a.defaultText||t.$t("Please type to search")),1)):(p(),j("span",De,D(t.$t("No suggestions to list.")),1))])])]))],8,Ce)],2),[[ke,N.value]])],512),a.error?(p(),_(Se,{key:0,message:a.error.replace(" id",""),class:"mt-0"},null,8,["message"])):M("",!0)],512)}}};export{Ue as _};
